import sys
from collections import defaultdict
lines_in = [line.strip() for line in sys.stdin]

# calculated by figuring out as many monkeys as we could without making use of 'humn'
known_monkeys = {'dnln': 24, 'rfbj': 15, 'dzpq': 10, 'qfzc': 8, 'pzfg': 26, 'zqjq': 45, 'plrt': 17, 'bljg': 6, 'lhmm': 34, 'vvcm': 9, 'mvlq': 7, 'vtzc': 289, 'nnps': 42, 'dqzl': 45, 'rhnn': 46, 'mnhq': 13, 'tjgm': 7, 'qpgc': 45, 'dftb': 13, 'dfzh': 6, 'rdjm': 26, 'dqpl': 9, 'bwhs': 6, 'gtpb': 14, 'flfg': 8, 'prpb': 17, 'ccbt': 16, 'jbgn': 21, 'hfdr': 49, 'zvdr': 21, 'qzln': 108, 'dqlf': 12, 'lwrf': 23, 'dfcs': 6, 'gwhz': 15, 'cnwt': 8, 'hwsj': 35, 'hdpz': 8, 'hdtf': 7, 'wpbl': 8, 'pzlt': 46, 'vhmd': 6, 'gpng': 21, 'hgnj': 11, 'gtbv': 11, 'cmnw': 6, 'nprp': 6, 'hpjq': 7, 'mzcf': 7, 'qrqh': 9, 'wpjs': 7, 'hvfp': 35, 'tsgv': 7, 'chjp': 7, 'rplp': 8, 'wppf': 6, 'vsbc': 16, 'fsws': 7, 'fqwp': 13, 'bslg': 7, 'mfhb': 24, 'njmn': 11, 'mfcz': 22, 'ldds': 17, 'wlgf': 7, 'ftzz': 11, 'fjcq': 35, 'cjld': 15, 'jqmw': 9, 'ndrj': 6, 'vtsh': 24, 'pmlb': 15, 'zbdr': 14, 'wmwq': 6, 'wqrm': 60, 'cjfn': 19, 'cpbf': 11, 'fmrr': 25, 'ntqv': 6, 'ldhs': 6, 'zqhr': 8, 'lwlv': 16, 'bvgr': 24, 'mjcn': 27, 'hrcj': 8, 'gswg': 18, 'czff': 75, 'vbbw': 25, 'bnzm': 11, 'ssnj': 7, 'wnrz': 23, 'qpcp': 26, 'jphn': 6, 'lzsl': 10, 'nrgv': 9, 'qmdw': 11, 'wfjm': 8, 'lwmg': 10, 'lvjd': 50, 'wctn': 7, 'gsmq': 33, 'mtsq': 10, 'gjpt': 8, 'qrgt': 10, 'tvmv': 26, 'qvdz': 32, 'zsdd': 27, 'cqvg': 11, 'mjtg': 39, 'qzhz': 10, 'gczl': 7, 'fqwl': 14, 'jssd': 42, 'fbbj': 26, 'cbqr': 6, 'jslm': 37, 'qthf': 7, 'cbdz': 26, 'cqfn': 9, 'mbtb': 10, 'dtcg': 10, 'nrts': 10, 'zgwt': 8, 'nfrt': 10, 'tzpc': 11, 'rczt': 13, 'ddsm': 6, 'wdps': 28, 'bfjz': 7, 'cmzg': 25, 'mgjc': 14, 'drcd': 25, 'qwzv': 6, 'qmsf': 260, 'gmng': 9, 'vhsb': 15, 'sgmv': 27, 'dzps': 49, 'dbvw': 8, 'ghsq': 21, 'jnsp': 24, 'ldpp': 6, 'gtss': 7, 'wlnz': 11, 'bhwr': 24, 'gvsw': 11, 'vhjz': 85, 'qlsn': 9, 'zphs': 18, 'gphs': 16, 'mhdd': 8, 'fgmp': 35, 'vjps': 16, 'qsjd': 59, 'rcgz': 27, 'tnfn': 54, 'pbds': 16, 'vcsh': 54, 'hchb': 55, 'fcnz': 10, 'rrhp': 10, 'gcsd': 7, 'mbpp': 7, 'pvmt': 6, 'tdwc': 27, 'mnsm': 36, 'jjwd': 47, 'rcls': 8, 'ltsz': 11, 'cptg': 20, 'vwph': 6, 'bchh': 15, 'mdsq': 649, 'dbjn': 24, 'mlvg': 31, 'dtdc': 9, 'njfl': 23, 'drtl': 27, 'bmsz': 22, 'vhrh': 9, 'dzsr': 6, 'hpfd': 14, 'smcr': 8, 'qlnq': 8, 'mtbj': 21, 'gscs': 7, 'nvqd': 36, 'rpsh': 9, 'ltdc': 8, 'pcjz': 31, 'wgzp': 18, 'sqtq': 128, 'lcng': 22, 'fhhz': 55, 'rfmw': 25, 'pscf': 19, 'nrbw': 80, 'qhff': 10, 'mmjs': 22, 'jqbg': 8, 'rwhn': 13, 'stnd': 25, 'lsrd': 323, 'vqwz': 111, 'wvfq': 24, 'fdpr': 9, 'gbtl': 6, 'jjdc': 6, 'lwpz': 13, 'psld': 14, 'hmjv': 44, 'glhb': 16, 'tqnj': 27, 'phdw': 37, 'sdsz': 12, 'brpv': 578, 'pfvt': 27, 'lgqz': 35, 'tbcb': 39, 'pqtf': 34, 'mgvm': 6, 'cnsn': 7, 'wsbp': 15, 'dztg': 44, 'tgzt': 16, 'vpsw': 7, 'qpmp': 19, 'rcth': 48, 'pjgp': 30, 'dbrj': 23, 'qvsn': 8, 'dzjr': 6, 'rrqw': 23, 'cwmg': 24, 'vsbt': 91, 'ldws': 6, 'wmzd': 21, 'rjlc': 60, 'jjjw': 7, 'htbp': 9, 'mdhl': 105, 'lgsq': 85, 'cpvv': 8, 'dzvp': 6, 'svvb': 578, 'cmrw': 198, 'jnvd': 66, 'lrdp': 34, 'fccd': 93, 'zqsv': 8, 'pjwb': 11, 'psfg': 162, 'swjm': 56, 'thln': 62, 'jvph': 9, 'jznn': 25, 'czps': 644, 'zrvq': 11, 'dwnm': 10, 'zhtb': 29, 'dvpm': 21, 'zdms': 38, 'cwgv': 7, 'jjjs': 35, 'zchq': 7, 'frbq': 6, 'zmwt': 8, 'vspg': 9, 'znzr': 855, 'bglg': 7, 'zlch': 8, 'dlzs': 12, 'cjvz': 35, 'mvpz': 9, 'ncdr': 7, 'rfhl': 46, 'tznp': 34, 'ftrh': 6, 'phmz': 59, 'gbdz': 26, 'ptsl': 6, 'zlsf': 14, 'cjrc': 15, 'zvrw': 30, 'znpf': 12, 'bvgj': 16, 'qshs': 11, 'vlcf': 10, 'ncml': 32, 'jnbv': 7, 'lchw': 6, 'mwqw': 7, 'fzzg': 23, 'svzn': 6, 'rtvn': 22, 'dgwm': 32, 'gsvd': 32, 'gqvj': 36, 'szzc': 10, 'zbzg': 31, 'pbtp': 20, 'hnjh': 8, 'dfvw': 7, 'cfzd': 34, 'mpgg': 10, 'dsmj': 31, 'hblh': 24, 'hfwr': 8, 'bfqh': 23, 'njvj': 12, 'trtg': 7, 'mrjj': 8, 'bbcb': 15, 'cnff': 32, 'zdpc': 6, 'gtjl': 18, 'wftw': 6, 'lgtm': 7, 'ljlj': 23, 'wtmg': 21, 'cwnl': 21, 'fmjl': 23, 'pslg': 6, 'gfwv': 90, 'vjfj': 35, 'lshs': 23, 'cjvt': 8, 'htmv': 13, 'rlhf': 130, 'wmwl': 23, 'fdcf': 6, 'gmgj': 9, 'rmfd': 43, 'tgjs': 221, 'mdfq': 21, 'lzsh': 36, 'jggl': 6, 'vdwj': 25, 'nvlt': 18, 'dhnv': 135, 'msnl': 117, 'ptlc': 18, 'dsdm': 22, 'vfbp': 22, 'lbqf': 11, 'wwsb': 9, 'zflt': 12, 'rcqv': 57, 'ngnw': 85, 'vfph': 8, 'wcwt': 25, 'tfjp': 7, 'qcfp': 22, 'vvhw': 11, 'gbhl': 10, 'mhht': 42, 'vchv': 11, 'vtnh': 31, 'rhsm': 19, 'ncpr': 7, 'jrmq': 7, 'lrvl': 10, 'fppq': 6, 'fhsb': 10, 'wjlc': 10, 'rhbt': 9, 'wtds': 7, 'qhpg': 65, 'zlwv': 65, 'tnzp': 26, 'ffzr': 39, 'qqvh': 7, 'lngg': 19, 'lscd': 8, 'jlmh': 11, 'wbbd': 8, 'fpnl': 29, 'zhmc': 40, 'vccw': 7, 'tffz': 10, 'tfqp': 51, 'mphz': 10, 'qjqj': 18, 'zgmz': 15, 'nvnq': 42, 'fgsb': 37, 'fjrb': 22, 'lbjh': 94, 'vqml': 21, 'cvnz': 117, 'vnqz': 30, 'rsmv': 7, 'sthq': 7, 'wlmd': 19, 'sdnw': 31, 'tmql': 52, 'hbvw': 23, 'hffg': 41, 'tlhr': 9, 'fsdv': 13, 'mphh': 222, 'hccn': 23, 'wswr': 30, 'rnjs': 21, 'jhlm': 6, 'cffj': 23, 'pgrz': 13, 'qmnn': 10, 'fdvf': 17, 'drnn': 8, 'ggcl': 9, 'dwbq': 6, 'mpfv': 38, 'jjld': 29, 'hjfj': 24, 'ssbv': 68, 'qwmj': 13, 'lmql': 11, 'rwcf': 23, 'mmhm': 6, 'fzdf': 77, 'shfb': 24, 'ftmj': 7, 'ldzw': 195, 'ljmp': 22, 'fvqm': 16, 'ddzb': 90, 'wjdt': 11, 'bqvn': 79, 'gdsf': 8, 'jtdr': 17, 'qtcw': 62, 'drzq': 16, 'vfnm': 9, 'zvls': 11, 'bsqq': 63, 'tljh': 34, 'rdwt': 23, 'slgg': 21, 'bczp': 31, 'tcbr': 19, 'zbwl': 33, 'lmcj': 12, 'snrs': 48, 'gtcc': 16, 'qvvl': 6, 'rpwm': 29, 'wwgb': 36, 'hwlp': 34, 'ztgp': 129, 'wbnm': 105, 'mjbm': 6, 'mzbl': 24, 'wrjw': 57, 'vzrj': 119, 'fddj': 289, 'qgdn': 27, 'sttp': 50, 'ppml': 31, 'bfpc': 50, 'vtht': 51, 'jpdm': 13, 'hpth': 35, 'mfdq': 22, 'grgq': 14, 'zdsc': 42, 'jqcj': 17, 'nzpc': 110, 'tcnz': 141, 'vdlh': 224, 'mslh': 12, 'nswf': 24, 'qprs': 24, 'qwmg': 28, 'dpfd': 26, 'ctgb': 74, 'vtlm': 702, 'dnwc': 36, 'wccj': 116, 'hdsc': 17, 'tvhs': 53, 'tfhg': 11, 'bcmc': 69, 'qmtb': 122, 'dqwl': 11, 'vnld': 124, 'vjvn': 318, 'rjpr': 29, 'zwsl': 80, 'mrmt': 102, 'rsdg': 124, 'tsjl': 7, 'llfp': 18, 'vtsq': 13, 'sbfm': 84, 'lswb': 37, 'qmvs': 35, 'jhnj': 53, 'ttzw': 50, 'jpwq': 96, 'mzdl': 103, 'jtsl': 28, 'hzpb': 15, 'sswc': 25, 'zznh': 72, 'qzjr': 11, 'dncm': 11, 'cwsp': 201, 'gvjq': 16, 'vbql': 27, 'gmlz': 96, 'zqst': 54, 'qhcf': 47, 'dfdq': 45, 'jtdt': 54, 'hhrw': 31, 'fbbc': 19, 'twsz': 30, 'mmnb': 7, 'dgwr': 13, 'brnz': 32, 'tjng': 56, 'rnbt': 31, 'jlqd': 27, 'bjlm': 148, 'jtsj': 476, 'wfvj': 115, 'vdss': 68, 'nvtj': 38, 'btgq': 27, 'jrlb': 17, 'fsqw': 49, 'svlh': 13, 'ssmd': 65, 'vfpj': 402, 'nwfz': 31, 'wjgf': 19, 'mpzl': 11, 'njlv': 68, 'grnj': 51, 'hpwz': 10, 'jvbt': 38, 'qmzd': 37, 'mqsw': 38, 'pfzp': 45, 'bcns': 55, 'qwsz': 19, 'jmgd': 26, 'vvgn': 37, 'nqhv': 378, 'qbcj': 27, 'qpnt': 35, 'cfgb': 50, 'cnhz': 63, 'dvlf': 23, 'nrzm': 152, 'tjbt': 27, 'hlwg': 205, 'sjqt': 21, 'wjjv': 49, 'pzds': 53, 'mmsg': 53, 'gzbn': 19, 'bgpp': 23, 'fbcs': 29, 'trrw': 50, 'qrsr': 24, 'mjlq': 19, 'qzcd': 24, 'thqr': 37, 'rpwp': 14, 'gcsg': 6, 'bldq': 46, 'vwvg': 23, 'hgwn': 32, 'gfbl': 768, 'bmjl': 33, 'sfzg': 63, 'tnbz': 17, 'fjff': 12, 'ztlg': 29, 'ttns': 175, 'slbh': 65, 'fgds': 36, 'cmbq': 52, 'pdjw': 18, 'qsjt': 10, 'znzl': 47, 'wttj': 30, 'wflt': 74, 'jrrm': 21, 'hvzf': 651, 'cjss': 21, 'fdng': 7, 'wptn': 37, 'mvzz': 23, 'fdqt': 11, 'mhhn': 79, 'vmzj': 37, 'vvzg': 13, 'ssbs': 19, 'lchn': 23, 'gvlp': 207, 'lcqp': 7, 'drcv': 28, 'mlmt': 16, 'lrzc': 70, 'qzmz': 11, 'qsgq': 31, 'jmdc': 38, 'mmml': 31, 'qhhz': 21, 'cgjv': 34, 'jrrd': 36, 'fzht': 918, 'sljh': 646, 'trfz': 47, 'bctw': 69, 'vdcs': 11, 'fbwp': 97, 'sscc': 170, 'jgfv': 48, 'wtjw': 442, 'jtff': 47, 'hznq': 27, 'lngz': 4025, 'tlvv': 18, 'vttr': 325, 'jjtb': 97, 'cnrt': 114, 'fvsv': 93, 'dvfn': 42, 'svrd': 61, 'vjfw': 22, 'qnmd': 23, 'ghvj': 23, 'pftw': 43, 'wvjt': 115, 'zmjc': 43, 'srvn': 209, 'jzng': 44, 'zzbp': 1155, 'fzmb': 53, 'zmwg': 194, 'tnnp': 95, 'zwqv': 37, 'tjbr': 78, 'wlhz': 24, 'fhsm': 118, 'ccmp': 43, 'hqfl': 37, 'wcts': 14, 'qssl': 32, 'zwbd': 33, 'jdtm': 11, 'qwcj': 44, 'pglw': 89, 'lzrs': 190, 'jtwf': 122, 'spjf': 7, 'hggg': 88, 'pbtj': 37, 'trnj': 529, 'jhht': 206, 'vbgq': 57, 'mdqh': 368, 'fcvw': 76, 'nqjg': 19, 'qzfg': 457, 'qmsh': 423, 'cbsh': 85, 'jpqn': 39, 'tdrz': 148, 'gmll': 265, 'jgln': 58, 'bsdt': 33, 'flhg': 243, 'nvzb': 135, 'jqnp': 121, 'rpqq': 46, 'pszl': 25, 'ttmz': 67, 'ddjn': 20, 'cqgb': 15, 'rtrd': 76, 'bmdp': 61, 'wlhj': 442, 'ztws': 23, 'glvz': 397, 'mwsp': 55, 'tpnz': 414, 'bcjc': 11, 'smww': 78, 'nmjh': 41, 'brjs': 17, 'wmcm': 550, 'gnvj': 62, 'llsq': 696, 'zrqc': 26, 'rbrw': 28, 'rqds': 44, 'nmds': 69, 'cwfw': 50, 'mbqf': 400, 'crhl': 59, 'ssqb': 22, 'qjfb': 99, 'dhqh': 202, 'vzqt': 10, 'ddww': 103, 'vbmz': 75, 'gfzh': 14, 'zllb': 11, 'gqjs': 97, 'jjzg': 162, 'lvpg': 86, 'plbl': 12, 'wfls': 2285, 'vwqq': 189, 'fcpw': 44, 'chhf': 20, 'dqsf': 43, 'wwcz': 37, 'mmzv': 124, 'gbcg': 74, 'jcnt': 22, 'qlzg': 26, 'gnhs': 144, 'gzfp': 752, 'zchf': 43, 'vcsj': 17, 'cwph': 23, 'bcvl': 43, 'gfhj': 34, 'zvdf': 33, 'lcsp': 69, 'thcc': 605, 'dvwt': 76, 'ngth': 62, 'njdj': 21, 'fsrh': 54, 'jmnr': 13, 'clrf': 194, 'rhpm': 23, 'zqjj': 275, 'cgbw': 14, 'tvfb': 468, 'nhvz': 407, 'hmqm': 63, 'lfth': 95, 'bwgt': 313, 'bggc': 59, 'hmsc': 108, 'mrfl': 53, 'prcp': 49, 'twzq': 35, 'mntl': 44, 'pppl': 7, 'nbqz': 1191, 'dcrq': 78, 'tjbc': 530, 'hbnq': 67, 'flbz': 25, 'mffv': 66, 'jgqj': 11, 'fgtr': 64, 'whls': 185, 'shdn': 49, 'ldtn': 34, 'vmwn': 70, 'whnl': 88, 'dnzf': 86, 'bbtr': 85, 'gcgz': 544, 'qsnb': 305, 'vqpb': 12, 'fffd': 93, 'jfzh': 715, 'rwwd': 51, 'qtwn': 89, 'rbwb': 22, 'ndvr': 49, 'fmwl': 95, 'vfhz': 88, 'lgcz': 123, 'lrlc': 125, 'ncvr': 2072, 'jtgt': 41, 'gsvv': 11, 'nvgt': 29, 'svtl': 27, 'clbm': 106, 'wvlw': 141, 'bvtw': 504, 'trnp': 127, 'vpmn': 875, 'jtzl': 46, 'vgwj': 79, 'dqpm': 469, 'cfln': 22, 'ndnr': 1422, 'znzf': 1519, 'grsn': 53, 'ltvh': 48, 'mrml': 47, 'fhsp': 106, 'dqpn': 251, 'gdjm': 66, 'bdvq': 105, 'drtr': 23, 'jjbz': 590, 'bvqv': 231, 'bfng': 25, 'pfzg': 502, 'fqql': 43, 'swqw': 92, 'nzlr': 23, 'fcrf': 172, 'nndr': 38, 'glfg': 263, 'tngn': 257, 'bvgq': 21, 'zwnf': 220, 'qrhh': 239904, 'vbpw': 14, 'nthb': 29, 'jgtn': 206, 'jldb': 59, 'hhmq': 50, 'wcvs': 71, 'zzsg': 925, 'mhpj': 709, 'sbbh': 2528, 'wjhp': 57, 'grrh': 114, 'bdtr': 441, 'rnhb': 1326, 'znwj': 22, 'fzfz': 23, 'zzfz': 11, 'hfvn': 17, 'mrsr': 129, 'jmzf': 35, 'hffh': 71, 'mwhw': 979, 'wrtm': 53, 'bzls': 47, 'wrzp': 691, 'gvcw': 242, 'sgzl': 29, 'tftf': 13, 'gmnp': 142, 'ccjz': 37, 'nqdr': 58, 'jtqt': 79, 'ftvr': 938, 'fvnn': 124, 'ddsn': 281, 'gqcm': 17, 'vcjl': 74, 'dpvb': 97, 'jbln': 127, 'ftrf': 11, 'vdmn': 136, 'hnbj': 2394, 'bmqf': 116, 'srrq': 89, 'grpm': 123, 'vzhb': 1196, 'qmss': 22, 'dbmh': 98, 'zjfj': 158, 'jvcs': 87, 'bhpw': 1264, 'gmpq': 14, 'fqlz': 68, 'dsjr': 93, 'zwcq': 47, 'fhld': 58, 'jdqd': 52, 'bptf': 44, 'wltv': 1418, 'sdld': 59, 'vrzs': 606, 'vjmv': 1382, 'mjvz': 222, 'dwzh': 61, 'dznq': 5321, 'tlzl': 73, 'rwqv': 155, 'twbw': 149, 'snmw': 208, 'vlgv': 107, 'zgdn': 21, 'hwvm': 163, 'brwc': 610, 'qvpv': 53, 'nbsd': 167, 'tdzr': 17966, 'cnsr': 17, 'gtzd': 80, 'mgfp': 367, 'hfmg': 813, 'qmsg': 284, 'hrzr': 2060, 'qlzh': 179, 'wqlz': 63, 'hlvv': 114, 'vvjs': 768, 'hthb': 334, 'gvjh': 23, 'rvsc': 705, 'rwwm': 568, 'gdjv': 106, 'nrmv': 54, 'bcdz': 1603, 'ddjv': 87, 'bsql': 210, 'tsgp': 88, 'mmpl': 184, 'dfcf': 58, 'crcv': 118, 'ggds': 271, 'jwqg': 53, 'rdpq': 798, 'fnrs': 29, 'wcpd': 3922, 'ccbh': 116, 'pczp': 688, 'pmtt': 94, 'fqhh': 396, 'ltrd': 158, 'vpld': 296, 'dngq': 395, 'rvrr': 103, 'bzqj': 127, 'crqf': 14, 'hgnm': 1004, 'dhpc': 41, 'rqvg': 267, 'bbgf': 74, 'zqmf': 2461, 'rzmm': 19, 'nfth': 316, 'sjrj': 43, 'dvqc': 59, 'lpmb': 31, 'rlwh': 495, 'wwhg': 413, 'nbln': 87, 'bmpw': 949, 'thql': 979, 'njfb': 178, 'zfdn': 889, 'qljt': 622, 'frsn': 69, 'zczb': 41, 'qgqg': 153, 'wjtz': 232, 'rdzt': 173, 'vrdl': 14, 'tngp': 1118, 'zgrp': 5469, 'mswf': 201, 'jwvh': 150, 'qqqr': 93, 'rwlv': 79, 'gpsg': 13, 'bpmn': 127, 'lznj': 23, 'tpbh': 29, 'rtnp': 327, 'rjlj': 263, 'vbhw': 142, 'dndj': 146, 'cqlt': 67, 'jvwm': 47, 'jbjf': 236, 'swqg': 23, 'lbnn': 237, 'jlvf': 189, 'ppbl': 1654, 'qhcv': 23, 'jcdn': 236, 'bjrt': 76, 'fbpz': 895, 'rnvj': 789, 'fvrw': 19157, 'wdmg': 489, 'gwvp': 815, 'pshj': 314, 'ctzh': 2004, 'srbf': 2467, 'czsc': 29, 'mzsv': 2243, 'ddtr': 288, 'lwrb': 211, 'jmbh': 64, 'btjh': 604, 'bnzh': 71, 'svjc': 6383, 'tvrt': 233, 'fsnr': 521, 'wjtf': 11736, 'mpqn': 86, 'qdlm': 148, 'jjht': 179, 'bffz': 3011, 'gzvd': 198, 'nhvd': 29, 'mdcz': 206, 'nbbn': 905, 'crzh': 103, 'hzmp': 1823, 'rqrj': 692, 'bfbh': 51, 'gbjw': 42, 'mrlb': 472, 'jptw': 66, 'fswh': 254, 'zmth': 346, 'wzql': 4934, 'lttt': 82, 'zgmn': 79, 'gfms': 217, 'jpvw': 521, 'frll': 269, 'rlfj': 33, 'mtzd': 400, 'wwng': 43, 'zqwm': 251, 'nfsp': 474, 'tvwv': 358, 'blms': 863, 'zrwl': 69, 'pztp': 141, 'fnnt': 633, 'vzhg': 137, 'tqqm': 807, 'pjcp': 134, 'qcgh': 157, 'zqhz': 317, 'pbwb': 193, 'hdrn': 43, 'jbrg': 9033, 'tjjv': 347, 'qnpv': 611816, 'wldg': 38314, 'vbds': 1451, 'sfgp': 179, 'phbs': 781, 'nhzj': 772, 'mpfl': 502, 'lslb': 2411, 'fwjt': 15761, 'sspm': 1548, 'bzrc': 15224, 'fszv': 142, 'mhwm': 823, 'dcrs': 215, 'sbzr': 395, 'vgqz': 1042, 'cbcf': 601, 'zmmf': 41, 'mcqw': 154, 'cfnh': 193, 'spmr': 8883, 'jwdq': 129, 'htjj': 67, 'dmcq': 66, 'tlcb': 19157, 'fqzp': 329, 'qtcf': 1266, 'scgv': 209, 'djmd': 314, 'tplh': 683, 'fqsn': 211, 'bjbt': 9053, 'jpmj': 2141, 'tfgg': 47, 'rjbt': 1351, 'cpsp': 774, 'hfcg': 157, 'jhwt': 348, 'dgvd': 92158, 'tfnd': 571, 'zmjv': 9433, 'tmtg': 2789, 'grpw': 579, 'wcnd': 94, 'dlml': 23216, 'mlgd': 1366, 'zzzz': 929899, 'rrgg': 351, 'bfws': 87, 'wscp': 5805, 'fscc': 643, 'cnrj': 1202, 'fcmn': 4488, 'sngp': 29, 'glmw': 38314, 'nzln': 1286, 'fwfp': 422, 'smpt': 211, 'nqhd': 101041, 'fmbf': 114942, 'gpzm': 422, 'rjwl': 11156, 'jzdj': 10129, 'jbtq': 418, 'mnwj': 1142, 'rjjd': 1620, 'hdpg': 4282, 'hphc': 983, 'wvqp': 7001, 'qsqf': 471, 'hjnj': 35, 'hlmg': 47, 'rnfm': 6548, 'rnvp': 1840, 'msdt': 3359, 'cnfz': 26967071, 'bbsd': 106, 'jrpr': 7703, 'qfjq': 4933, 'rvbw': 810, 'mbvz': 2141, 'hshw': 3583, 'bjrh': 2509, 'wzhw': 37686, 'jwgs': 21285, 'gcgm': 617, 'pcdw': 968, 'gpfw': 91726, 'cqvv': 24665, 'vsfw': 14332, 'cwth': 94, 'dpmh': 5573, 'fdnj': 146357, 'wtlw': 37, 'mhps': 63009, 'qspl': 1024286, 'ntcf': 2731, 'nsdv': 192767, 'zbjt': 47, 'wzcd': 517965, 'tprt': 1413, 'cshb': 963835, 'rngg': 6746845, 'dmvh': 4257, 'pgzb': 53, 'stzn': 1542251, 'nbsl': 94, 'rfhz': 6995, 'cjnc': 59, 'dvzq': 48677, 'rbdh': 106, 'rjfr': 3849, 'lpdd': 15430609, 'cglw': 2906, 'ppfr': 2544, 'gldn': 2472228353, 'tqhz': 118, 'mznj': 73, 'ngsn': 478348879, 'gzbh': 246899, 'qvcc': 19073, 'nqgl': 11597, 'vhmn': 146, 'wjwh': 5678677, 'qszd': 1453, 'mnwc': 708, 'tsjt': 18889, 'whtv': 6618331, 'dnhg': 876, 'pjjr': 505315950, 'fzsp': 23194, 'qbqp': 2977544303, 'bgjp': 3474305447432, 'jvjf': 42083, 'gblv': 4207270100139, 'qhfq': 7681575547571, 'jdfw': 215084115331988, 'gszz': 84166, 'dtgg': 336664, 'trfp': 483021, 'hwrf': 520707, 'rlqc': 7139038, 'vglr': 48165982835110}

def get_monkeys(humn=None):
    monkeys = defaultdict(None)
    for m in lines_in:
        name, num = m.split(': ')
        if name in known_monkeys:
            monkeys[name] = known_monkeys[name]
            continue
        if humn is not None and name == 'humn': monkeys['humn'] = humn
        else:
            try: monkeys[name] = int(num)
            except: monkeys[name] = num.split(' ')
    return monkeys

def riddle(humn=None):
    monkeys = get_monkeys(humn)
    while type(monkeys['root']) is not (int if humn is None else bool):
        for m in monkeys:
            if type(monkeys[m]) is int: continue
            a, op, b = monkeys[m]
            if type(monkeys[a]) is int and type(monkeys[b]) is int:
                if humn is not None and m == 'root': monkeys[m] = monkeys[a] == monkeys[b]
                elif op == '+': monkeys[m] = monkeys[a] + monkeys[b]
                elif op == '-': monkeys[m] = monkeys[a] - monkeys[b]
                elif op == '*': monkeys[m] = monkeys[a] * monkeys[b]
                elif op == '/': monkeys[m] = monkeys[a] // monkeys[b]
    return monkeys['root']

print('part 1', riddle())

# not proud of this... calculated it manually
# (((215084115331988 - ((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((318 * (768 + ((x - 876) / 9))) + 325) / 11) - 918) * 2) + 798) / 2) - 905) * 12) - 752) / 2) + 688) * 2) + 702) * 2) - 442) / 2) + 579) / 4) - 231) * 2) - 137) * 2) + 103) + 968) / 9) + 50) * 2) - 39) + 622) + 889) / 6) + 194) * 8) - 106) / 2) - 69) / 2) + 646) * 4) + 314) / 2) - 938) * 7) + 207) / 6) - 6) * 4) - 895) + 925) / 2) + 781) * 2) + 789) * 2) - 863) / 3) - 606) + 201) / 2) + 8) * 4)) / 4) + 708) * 2 = 48165982835110
# https://www.mathpapa.com/equation-solver/

trying = 3342154812537
while True:
    is_correct = riddle(humn=trying)
    if is_correct: break
    # this got to ~30000 before I decided the number might be huge and that brute-forcing would not work. I was correct.
    trying += 1

print('part 2', trying)
